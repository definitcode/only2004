[label,burn_log](obj $logs)
if ($logs = logs) {
} else if ($logs = oak_logs) {
    if (stat_base(firemaking) < 15) {
        mes("You need a firemaking level of 15 to burn this logs.");
        return;
    }
} else if ($logs = willow_logs) {
    if (stat_base(firemaking) < 30) {
        mes("You need a firemaking level of 30 to burn this logs.");
        return;
    }
} else if ($logs = maple_logs) {
    if (stat_base(firemaking) < 45) {
        mes("You need a firemaking level of 45 to burn this logs.");
        return;
    }
} else if ($logs = yew_logs) {
    if (stat_base(firemaking) < 60) {
        mes("You need a firemaking level of 60 to burn this logs.");
        return;
    }
} else if ($logs = magic_logs) {
    if (stat_base(firemaking) < 75) {
        mes("You need a firemaking level of 75 to burn this logs.");
        return;
    }
}
// --- tinderbox detection ---
def_namedobj $tbox = null;
if (inv_total(inv, tinderbox) > 0) {
    $tbox = tinderbox;
} else if (inv_total(inv, hc_tinderbox) > 0) {
    $tbox = hc_tinderbox;
} else if (inv_total(inv, dragon_tinderbox) > 0) {
    $tbox = dragon_tinderbox;
} else if (inv_total(inv, rune_tinderbox) > 0) {
    $tbox = rune_tinderbox;
} else if (inv_total(inv, adamant_tinderbox) > 0) {
    $tbox = adamant_tinderbox;
} else if (inv_total(inv, mithril_tinderbox) > 0) {
    $tbox = mithril_tinderbox;
} else if (inv_total(inv, steel_tinderbox) > 0) {
    $tbox = steel_tinderbox;
} else if (inv_total(inv, iron_tinderbox) > 0) {
    $tbox = iron_tinderbox;
} else if (inv_total(inv, bronze_tinderbox) > 0) {
    $tbox = bronze_tinderbox;
} else if (inv_total(inv, founders_tinderbox) > 0) {
    $tbox = founders_tinderbox;
}

if ($tbox = null) {
    mes("You need a tinderbox to light a fire.");
    return;
}
// --- tinderbox animation selection ---
def_seq $anim_id = null;
def_int $random1 = random(2);
def_int $delay = 0;
def_int $formula = calc($random1 + $delay);
def_int $random = random(100);
def_int $success = add($random,stat_base(firemaking));

if ($tbox = tinderbox) {
    $anim_id = human_createfire;
    $delay = 4;
} else if ($tbox = hc_tinderbox) {
    $anim_id = human_hccreatefire;
    $delay = 4;
} else if ($tbox = dragon_tinderbox) {
    $anim_id = human_dragoncreatefire;
    $delay = 1;
} else if ($tbox = rune_tinderbox) {
    $anim_id = human_runecreatefire;
    $delay = 2;
} else if ($tbox = adamant_tinderbox) {
    $anim_id = human_adacreatefire;
    $delay = 3;
} else if ($tbox = mithril_tinderbox) {
    $anim_id = human_mithrilcreatefire;
    $delay = 3;
} else if ($tbox = steel_tinderbox) {
    $anim_id = human_steelcreatefire;
    $delay = 3;
} else if ($tbox = iron_tinderbox) {
    $anim_id = human_ironcreatefire;
    $delay = 4;
} else if ($tbox = bronze_tinderbox) {
    $anim_id = human_bronzecreatefire;
    $delay = 4;
} else if ($tbox = founders_tinderbox){
    $anim_id = human_founderscreatefire;
    $delay = 4;
} else {
    $anim_id = human_createfire;
    $delay = 4;
}

if ($success > 150) {
    mes("You attempt to light the logs.");
    anim($anim_id, 0);
    sound_synth(tinderbox_strike, 0, 0);
    p_delay($delay);
    ~logsburning_success($logs, $tbox, $anim_id);

} else {
    mes("You attempt to light the logs.");
    anim($anim_id, 0);
    sound_synth(tinderbox_strike, 0, 0);
    p_delay(6);
    if ($success > 125){
        mes("You attempt to light the logs.");
        anim($anim_id, 0);
        sound_synth(tinderbox_strike, 0, 0);
        p_delay(3);
    } else {
        mes("You attempt to light the logs.");
        anim($anim_id, 0);
        sound_synth(tinderbox_strike, 0, 0);
        p_delay(6);
        if ($success > 50){
            mes("You attempt to light the logs.");
            anim($anim_id, 0);
            sound_synth(tinderbox_strike, 0, 0);
            p_delay(2);
            ~logsburning_success($logs, $tbox, $anim_id);
        } else {

        }
    }
}


[proc,logsburning_success](obj $logs, namedobj $tbox, seq $anim_id)
def_int $xp_mul = 0;
def_int $exp_raw = 0;
if ($tbox = tinderbox) {
    $xp_mul = 1;
} else if ($tbox = hc_tinderbox) {
    $xp_mul = 1;
} else if ($tbox = dragon_tinderbox) {
    $xp_mul = 4;
} else if ($tbox = rune_tinderbox) {
    $xp_mul = 3;
} else if ($tbox = adamant_tinderbox) {
    $xp_mul = 2;
} else if ($tbox = mithril_tinderbox) {
    $xp_mul = 2;
} else if ($tbox = steel_tinderbox) {
    $xp_mul = 1;
} else if ($tbox = iron_tinderbox) {
    $xp_mul = 1;
} else if ($tbox = bronze_tinderbox) {
    $xp_mul = 1;
} else if ($tbox = founders_tinderbox){
    $xp_mul = 1;
} else {
}

if ($logs = logs) {
    $exp_raw = 400;
} else if ($logs = oak_logs) {
    $exp_raw = 600;
} else if ($logs = willow_logs) {
    $exp_raw = 900;
} else if ($logs = maple_logs) {
    $exp_raw = 1350;
} else if ($logs = yew_logs) {
    $exp_raw = 2025;
} else if ($logs = magic_logs) {
    $exp_raw = 3038;
}
def_int $calced_exp = multiply($xp_mul, $exp_raw);
inv_del(inv, $logs, 1);
stat_advance(firemaking, $calced_exp);
if (inv_total(worn, cavalier_brown) > 0) {
            stat_advance(firemaking,$calced_exp);
            mes("Your firemaking skills are showing!");
}

sound_synth(fire_lit, 0, 0);
//mes("<tostring(map_clock)>, <tostring(%action_delay)>: The fire catches and the logs begin to burn.");
mes("The fire catches the logs, and it begins to burn.");
