[label,cast_prayer]
if (stat(prayer) > 9){
    def_int $random = random(10);
    def_string $prayer = "No Prayer";
    if (stat(magic) > 110) {
        ~mesbox("You need to wait before making another prayer!");
        return;
    }
    switch_int($random){
        case 0 : $prayer = "Ignis Voco Tempra";
        case 1 : $prayer = "Umbra Nex Mortem";
        case 2 : $prayer = "Sanctus Lux Veni";
        case 3 : $prayer = "Draco Silex Frangere";
        case 4 : $prayer = "Tempus Ardet Caeli";
        case 5 : $prayer = "Frigus Tenebris Clamare";
        case 6 : $prayer = "Vita Cruor Acceptum";
        case 7 : $prayer = "Aqua Serpentis Dormi";
        case 8 : $prayer = "Volatus Vox Umbrae";
        case 9 : $prayer = "Ordo Flammae Vindicta";
    }
    stat_drain(prayer, 10, 1);
    sound_synth(high_alchemy, 0, 0);
    anim(human_scythe_spin, 1);
    spotanim_pl(highlvlalchemy_casting, 92, 0);
    say("<$prayer>");
    stat_boost(magic, 1, 50);
    p_delay(1);

}


[label,meleeprayer]

if (p_finduid(uid) = true) {
    ~activate_prayer_protectfrommelee;
}
%prayer_protectfrommelee = %prayer_protectfrommelee;

[label,rangedprayer]

if (p_finduid(uid) = true) {
    ~activate_prayer_protectfrommissiles;
}
%prayer_protectfrommissiles = %prayer_protectfrommissiles;

[label,magicprayer]

if (p_finduid(uid) = true) {
    ~activate_prayer_protectfrommagic;
}
%prayer_protectfrommagic = %prayer_protectfrommagic;


[proc,activate_prayer_protectfrommelee]
//p_clearpendingaction;
def_dbrow $data = ~get_prayer_data(^prayer_protectfrommelee);
if ($data = null) {
    return;
}
if (%prayer_protectfrommelee = ^true) {
    %prayer_protectfrommelee = ^false;
    ~prayer_deactivate(^prayer_protectfrommelee);
    return;
}
if (~prayer_checks($data) = false) {
    %prayer_protectfrommelee = ^false;
    return;
}
def_int $levelreq = db_getfield($data, prayers:level, 0);
if (stat_base(prayer) < $levelreq){
    %prayer_protectfrommelee = ^false;
    sound_synth(prayer_off, 0, 0);
    ~mesbox("You need a @dbl@Prayer level of <tostring($levelreq)> to use <db_getfield($data, prayers:name, 0)>.");
    return;
}
%prayer_protectfrommelee = ^true;
~prayer_activate($data);

[proc,activate_prayer_protectfrommagic]
//p_clearpendingaction;
def_dbrow $data = ~get_prayer_data(^prayer_protectfrommagic);
if ($data = null) {
    return;
}
if (%prayer_protectfrommagic = ^true) {
    %prayer_protectfrommagic = ^false;
    ~prayer_deactivate(^prayer_protectfrommagic);
    return;
}
if (~prayer_checks($data) = false) {
    %prayer_protectfrommagic = ^false;
    return;
}
def_int $levelreq = db_getfield($data, prayers:level, 0);
if (stat_base(prayer) < $levelreq){
    %prayer_protectfrommagic = ^false;
    sound_synth(prayer_off, 0, 0);
    ~mesbox("You need a @dbl@Prayer level of <tostring($levelreq)> to use <db_getfield($data, prayers:name, 0)>.");
    return;
}
%prayer_protectfrommagic = ^true;
~prayer_activate($data);

[proc,activate_prayer_protectfrommissiles]
//p_clearpendingaction;
def_dbrow $data = ~get_prayer_data(^prayer_protectfrommissiles);
if ($data = null) {
    return;
}
if (%prayer_protectfrommissiles = ^true) {
    %prayer_protectfrommissiles = ^false;
    ~prayer_deactivate(^prayer_protectfrommissiles);
    return;
}
if (~prayer_checks($data) = false) {
    %prayer_protectfrommissiles = ^false;
    return;
}
def_int $levelreq = db_getfield($data, prayers:level, 0);
if (stat_base(prayer) < $levelreq){
    %prayer_protectfrommissiles = ^false;
    sound_synth(prayer_off, 0, 0);
    ~mesbox("You need a @dbl@Prayer level of <tostring($levelreq)> to use <db_getfield($data, prayers:name, 0)>.");
    return;
}
%prayer_protectfrommissiles = ^true;
~prayer_activate($data);